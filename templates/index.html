{% extends "base.html" %}
{% block title %}ホーム{% endblock %}

{% block content %}

<div class="max-w-6xl mx-auto mt-10 px-4">
    <div class="flex items-center mb-6">
        <i class="fa-solid fa-house text-primary text-3xl mr-3"></i>
        <h2 class="text-3xl font-bold">最新投稿</h2>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        {% for post in posts %}
        <div class="bg-white shadow rounded-xl p-5 hover:shadow-xl transition duration-200">
            
            <!-- サムネイル（動画優先） -->
            {% if post.video_public_id %}
                <img src="{{ get_safe_cloudinary_video_thumbnail(post.video_public_id, 600, 340) }}"
                    class="w-full h-60 object-cover rounded-lg"
                    alt="動画サムネイル">
            
            {% elif post.image_public_id %}
                <img src="{{ get_safe_cloudinary_url(post.image_public_id, width=600, height=340, crop='fill') }}"
                    class="w-full h-60 object-cover rounded-lg"
                    alt="サムネイル画像">
            {% endif %}

            <!-- タイトル -->
            <h3 class="mt-4 text-xl font-semibold">
                <a href="{{ url_for('view', post_id=post.id) }}"
                    class="hover:text-primary transition">
                    {{ post.title }}
                </a>
            </h3>

            <!-- 日時 -->
            <p class="text-gray-500 text-sm flex items-center mt-2">
                <i class="fa-regular fa-clock mr-2"></i>
                {{ post.created_at|datetimeformat }}
            </p>

        </div>
        {% endfor %}
    </div>

    <!-- ページネーション -->
    <div class="mt-10 flex justify-center space-x-4">
        {% if pagination.has_prev %}
        <a href="{{ url_for('index', page=pagination.prev_num, q=query_text) }}"
            class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300">
            前へ
        </a>
        {% endif %}

        {% if pagination.has_next %}
        <a href="{{ url_for('index', page=pagination.next_num, q=query_text) }}"
            class="px-4 py-2 bg-gray-200 rounded hover:bg-gray-300">
            次へ
        </a>
        {% endif %}
    </div>

</div>

{% endblock %}
